<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Pharmacie Andriamahefarivo</title>
    <link rel="shortcut icon" href="Common/icon.png" />
</head>
<body>
    <nav class="sidebar close">
        <header>
            <div id="program-content">
                <div class="image-text">
                    <span class="image">
                        <img src="Common/icon.png" alt="icon">
                    </span>
                        <div class="text header-text">
                        <span class="name">PHARMACIE ANDRIAMAHEFARIVO</span>
                    </div>
                </div>
                <i class="bare toggle"><img src="Common/fleche.png" alt="fleche"></i>
            </header>
            <div class="menu-bar">
                <div class="menu">
                    <li class="search-box">
                          <button onclick="searchProgram()"><img src="Common/recherche.png" alt="search"></button>  
                            <input type="text" id="search-bar" placeholder="Rechercher...">
                            <div id="search-results"></div>
                    </li>
                    <ul class="menu-minks">
                        <li class="nav-link">
                            <a href="#Operation" class="icon" title="Opérations">
                                <img src="Common/operation.png" alt="operation">
                                <span class="text nav-text">Operation Journalière</span>
                            </a>
                        </li>
                        <li class="nav-link">
                            <a href="Fournisseurs/Fournisseurs.html" class="icon" title="Fournisseurs">
                                <img src="Common/fournisseur.png" alt="fournisseur">
                                <span class="text nav-text">Fournisseurs</span>
                            </a>
                        </li>
                        <li class="nav-link">
                            <a href="Recette/Recette.html" class="icon" title="Recettes">
                                <img src="Common/recette.png" alt="recette">
                                <span class="text nav-text">Recette et versement</span>
                            </a>
                        </li>
                        <li class="nav-link">
                            <a href="Gestion 10%/Gestion.html" class="icon" title="Gestions 10%">
                                <img src="Common/gestion.png" alt="gestion">
                                <span class="text nav-text">Gestion 10%</span>
                            </a>
                        </li>
                        <li class="nav-link">
                            <a href="Stock/Stock.html" class="icon" title="Stock">
                                <img src="Common/stock.png" alt="stock">
                                <span class="text nav-text">Stock</span>
                            </a>
                        </li>
                        <li class="nav-link">
                            <a href="Bons/Bons.html" class="icon" title="Bons">
                                <img src="Common/bon.png" alt="bon">
                                <span class="text nav-text">Bons</span>
                            </a>
                        </li>
                        <li class="nav-link">
                            <a href="Payements/Payement.html" class="icon" title="Payement">
                                <img src="Common/payement.png" alt="payement">
                                <span class="text nav-text">Payement des personnels et Avance</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="bottom-content">
                    <li class="">
                        <a href="" class="icon" title="Déconnexion">
                            <img src="Common/logout.jpg" alt="logout">
                            <span class="text nav-text">Déconnexion</span>
                        </a>
                    </li>
    
                    <li class="mode">
                        <div class="moon-sun">
                            <img src="Common/moon.png" alt="moon" class="moon">
                        </div>
                        <span class="mode-text text">Dark Mode</span>
    
                        <div class="toggle-switch" title="Mode sombre">
                            <span class="switch"></span>
                        </div>
                    </li>
                </div>
            </div>
        </nav>
        <section class="home">
            <div class="text">
                <div class="user-warpper">
                    <img src="Common/profil.png" alt="profil">
                    <div>
                        <h3>
                            ANDRIAMAHEFARIVO Jeanson
                        </h3>
                    </div>
                    <div class="user-menu">
                      <div class="menu">
                        <ul>
                          <li>
                            <a href="Historique.html"><img src="Common/history.png" alt="" title="Historique"></a>
                            <a href="message.html"><img src="Common/message.png" alt="message" title="Messages"></a>
                            <a href="C:/Users/ASUS/Desktop/Pharmacie/Caisse%20Calculatrice/Caisse.html"><img src="Common/caisse.jpg" alt="" title="Caisse"></a>
                            <a href="plannig.html"><img src="Common/plannig.png" alt="" title="Planing"></a>
                          </li>
                        </ul>
                      </div>
                    </div>
                </div>
              </div>
                <main>
                  <br>
                  <div class="card" id="Operation">
                    <h2>Opération Journalière</h2>
                    <br>
                    <form>
                        <input type="datetime-local" name="Date" id="Datetime">
                        <input type="text" placeholder="Operation Journalière" id="operation">
                        <input type="text" placeholder="Montant en ariary" name="num1" id="num1">
                        <input type="text" placeholder="Taxe" name="num2" id="num2">
                        <input type="text" placeholder="Montant Hors Taxe" name="num3" id="num3">
                        <br>
                        <br>
                        <button type="button" onclick="addData();">Ajouter</button>
                    </form>
                    <br>
                    <table style="width: 100%">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Operations</th>
                                <th>Montant</th>
                                <th>Taxe</th>
                                <th>Montant Hors Taxe</th>
                                <th>Montant Total</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody" style="height: 400px;"></tbody>
                        <tfoot>
                            <tr>
                                <th><button type="button" onclick="addSubtotal()">Récapitulation</button></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th id="subtotal"></th>
                                <th id="total"></th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
            </main>
          </form>
        </div>
    </section>
    <script>
        // fonction pour ajouter les données dans le tableau et les stocker localement
function addData() {
  // récupérer les valeurs des inputs
  let date = document.getElementById("Datetime").value;
  let operation = document.getElementById("operation").value;
  let montant = parseFloat(document.getElementById("num1").value);
  let taxe = parseFloat(document.getElementById("num2").value);
  let montantHorsTaxe = montant / (1 + taxe / 100);
  let montantTotal = montant;

  // créer une nouvelle ligne pour le tableau
  let row = document.createElement("tr");
  row.innerHTML = `<td>${date}</td><td>${operation}</td><td>${montant}</td><td>${taxe}</td><td>${montantHorsTaxe.toFixed(2)}</td><td>${montantTotal.toFixed(2)}</td>`;

  // ajouter la nouvelle ligne dans le tableau
  let tableBody = document.getElementById("tableBody");
  tableBody.appendChild(row);

  // stocker les données localement
  let data = {
      date: date,
      operation: operation,
      montant: montant,
      taxe: taxe,
      montantHorsTaxe: montantHorsTaxe,
      montantTotal: montantTotal
  };

  let allData = JSON.parse(localStorage.getItem("data")) || [];
  allData.push(data);
  localStorage.setItem("data", JSON.stringify(allData));

  // réinitialiser les valeurs des inputs
  document.getElementById("Datetime").value = "";
  document.getElementById("operation").value = "";
  document.getElementById("num1").value = "";
  document.getElementById("num2").value = "";
}

let data = JSON.parse(localStorage.getItem("data"));

// vérifier si des données ont été stockées localement
if (data) {
    // parcourir les données et les afficher dans la console
    data.forEach((item) => {
        console.log(item.date);
        console.log(item.operation);
        console.log(item.montant);
        console.log(item.taxe);
        console.log(item.montantHorsTaxe);
        console.log(item.montantTotal);
    });
} else {
    console.log("Aucune donnée trouvée.");
}

const body = document.querySelector("body")
      sidebar = body.querySelector(".sidebar"),
      toggle = body.querySelector(".toggle"),
      searchBtn = body.querySelector(".search-box"),
      modeSwitch = body.querySelector(".toggle-switch"),
      modeText = body.querySelector(".mode-text");

      toggle.addEventListener("click", () =>{
        sidebar.classList.toggle("close");
      });
      searchBtn.addEventListener("click", () =>{
        sidebar.classList.remove("close");
      });

      modeSwitch.addEventListener("click", () =>{
        body.classList.toggle("dark");

        if(body.classList.contains("dark")){
            modeText.innerText = "Light Mode"
        }else{
            modeText.innerText = "Dark Mode"
        }
      });

      function searchProgram() {
  // Récupérer la valeur saisie dans la barre de recherche
  let searchTerm = document.getElementById("search-bar").value;
  
  // Récupérer le contenu du programme à rechercher
  let programContent = document.getElementById("program-content").textContent;
  
  // Utiliser une expression régulière pour chercher le terme dans le contenu du programme
  let regex = new RegExp(searchTerm, "gi"); // "gi" signifie "global" et "insensitive"
  let matches = programContent.match(regex);
  
  // Afficher les résultats de la recherche
  let resultsContainer = document.getElementById("search-results");
  
  // Effacer les résultats précédents
  while (resultsContainer.firstChild) {
    resultsContainer.removeChild(resultsContainer.firstChild);
  }
  
  // Ajouter les nouveaux résultats
  if (matches) {
    for (let i = 0; i < matches.length; i++) {
      let result = document.createElement("p");
      result.textContent = matches[i];
      resultsContainer.appendChild(result);
    }
  } else {
    let noResults = document.createElement("p");
    noResults.textContent = "Aucun résultat trouvé.";
    resultsContainer.appendChild(noResults);
  }
  return 0;
}
    </script>
</body>
</html>